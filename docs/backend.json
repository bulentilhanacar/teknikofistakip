{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents an authorized user in the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "The user's unique ID from Firebase Authentication."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "role": {
          "type": "string",
          "description": "The role of the user, which determines their permissions.",
          "enum": ["admin", "user"]
        }
      },
      "required": ["id", "email", "role"]
    },
    "Project": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Project",
      "type": "object",
      "description": "Represents a single construction project.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Project."
        },
        "name": {
          "type": "string",
          "description": "Name of the project."
        },
        "ownerId": {
          "type": "string",
          "description": "The UID of the user who owns this project."
        }
      },
      "required": ["id", "name", "ownerId"]
    }
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/entities/User"
          },
          "description": "Stores user data including their role. Access is restricted by security rules.",
          "params": [
            {
              "name": "userId",
              "description": "The unique ID of the user."
            }
          ]
        }
      },
      {
        "path": "/projects/{projectId}",
        "definition": {
          "entityName": "Project",
          "schema": {
            "$ref": "#/entities/Project"
          },
          "description": "Stores high-level project information. Access is controlled by roles: admins can access all projects, while users can only access projects where their UID matches the 'ownerId'.",
          "params": [
            {
              "name": "projectId",
              "description": "The unique ID of the project."
            }
          ]
        }
      },
      {
        "path": "/projects/{projectId}/contracts/{contractId}",
        "definition": {
          "description": "Sub-collection for contracts related to a project. Inherits permissions from the parent project."
        }
      },
      {
        "path": "/projects/{projectId}/deductions/{deductionId}",
        "definition": {
          "description": "Sub-collection for deductions related to a project. Inherits permissions from the parent project."
        }
      },
      {
        "path": "/projects/{projectId}/progressPayments/{paymentId}",
        "definition": {
          "description": "Sub-collection for progress payments related to a project. Inherits permissions from the parent project."
        }
      },
       {
        "path": "/projects/{projectId}/progressStatuses/{statusId}",
        "definition": {
          "description": "Sub-collection for progress statuses related to a project. Inherits permissions from the parent project."
        }
      }
    ]
  }
}
